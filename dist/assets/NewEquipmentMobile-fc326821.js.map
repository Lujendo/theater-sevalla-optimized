{"version":3,"file":"NewEquipmentMobile-fc326821.js","sources":["../../src/components/NewEquipmentMobile.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';\nimport { createEquipment } from '../services/equipmentService';\nimport { getEquipmentTypes } from '../services/equipmentTypeService';\nimport { getLocations } from '../services/locationService';\nimport { getCategories } from '../services/categoryService';\nimport { useAuth } from '../context/AuthContext';\nimport { Button } from './ui';\nimport { toast } from 'react-hot-toast';\nimport axios from 'axios';\nimport BarcodeScanner from './BarcodeScanner';\n\nconst NewEquipmentMobile = () => {\n  const navigate = useNavigate();\n  const { user } = useAuth();\n  const queryClient = useQueryClient();\n\n  // Form state\n  const [currentStep, setCurrentStep] = useState(1);\n  const [formData, setFormData] = useState({\n    type_id: '',\n    category_id: '',\n    category: '',\n    brand: '',\n    model: '',\n    serial_number: '',\n    location_id: '',\n    location: '',\n    status: 'available',\n    quantity: 1,\n    description: '',\n    reference_image_id: ''\n  });\n\n  const [files, setFiles] = useState([]);\n  const [error, setError] = useState('');\n  const [isSuccess, setIsSuccess] = useState(false);\n  const [showBarcodeScanner, setShowBarcodeScanner] = useState(false);\n\n  // Queries\n  const { data: typesData } = useQuery({\n    queryKey: ['equipment-types'],\n    queryFn: getEquipmentTypes,\n    staleTime: 300000,\n  });\n\n  const { data: locationsData } = useQuery({\n    queryKey: ['locations'],\n    queryFn: getLocations,\n    staleTime: 300000,\n  });\n\n  const { data: categoriesData } = useQuery({\n    queryKey: ['categories'],\n    queryFn: getCategories,\n    staleTime: 300000,\n  });\n\n  const { data: defaultStorageData } = useQuery({\n    queryKey: ['default-storage-locations'],\n    queryFn: async () => {\n      const response = await axios.get('/api/default-storage-locations');\n      return response.data;\n    },\n    staleTime: 300000,\n  });\n\n  // Set default storage location\n  useEffect(() => {\n    if (defaultStorageData?.defaultStorageLocations?.length > 0 && !formData.location_id) {\n      const defaultStorage = defaultStorageData.defaultStorageLocations[0];\n      setFormData(prev => ({\n        ...prev,\n        location_id: defaultStorage.location_id.toString(),\n        location: defaultStorage.location?.name || defaultStorage.name || 'Default Storage',\n        status: 'available'\n      }));\n    }\n  }, [defaultStorageData, formData.location_id]);\n\n  // Create mutation\n  const createMutation = useMutation({\n    mutationFn: createEquipment,\n    onSuccess: (data) => {\n      // Invalidate and refetch equipment queries\n      queryClient.invalidateQueries({ queryKey: ['equipment'] });\n      queryClient.invalidateQueries({ queryKey: ['equipment-list'] });\n      queryClient.invalidateQueries({ queryKey: ['equipment-summary'] });\n\n      setIsSuccess(true);\n      toast.success('Equipment created successfully!', { icon: '📱✅' });\n      setTimeout(() => {\n        navigate(`/equipment/${data.equipment.id}`);\n      }, 1500);\n    },\n    onError: (error) => {\n      console.error('📱 Mobile equipment creation error:', error);\n      console.error('📱 Error response:', JSON.stringify(error.response?.data, null, 2));\n      console.error('📱 Error status:', error.response?.status);\n      console.error('📱 Error message:', error.message);\n\n      const errorMessage = error.response?.data?.message || error.message || 'Failed to create equipment';\n      setError(errorMessage);\n      toast.error(`Failed to create equipment: ${errorMessage}`, { icon: '📱❌' });\n    },\n  });\n\n  // Handle input changes\n  const handleInputChange = (e) => {\n    const { name, value } = e.target;\n\n    console.log(`📱 Input change: ${name} = \"${value}\" (type: ${typeof value})`);\n\n    // Special handling for type selection\n    if (name === 'type_id') {\n      console.log('📱 Type selection:', value);\n      setFormData(prev => ({\n        ...prev,\n        type_id: value\n      }));\n    }\n    // Special handling for category selection\n    else if (name === 'category_id') {\n      const selectedCategory = categoriesData?.categories?.find(cat => cat.id.toString() === value);\n      setFormData(prev => ({\n        ...prev,\n        category_id: value,\n        category: selectedCategory?.name || ''\n      }));\n    }\n    // Special handling for location selection\n    else if (name === 'location_id') {\n      const selectedLocation = locationsData?.locations?.find(loc => loc.id.toString() === value);\n      setFormData(prev => ({\n        ...prev,\n        location_id: value,\n        location: selectedLocation?.name || ''\n      }));\n    } else {\n      setFormData(prev => ({ ...prev, [name]: value }));\n    }\n  };\n\n  // Handle barcode scan\n  const handleBarcodeScan = (scannedValue) => {\n    setFormData(prev => ({ ...prev, serial_number: scannedValue }));\n    setShowBarcodeScanner(false);\n    toast.success('Barcode scanned successfully!', { icon: '📱📷' });\n    // Auto-advance to next step after successful scan\n    if (currentStep === 2) {\n      setTimeout(() => nextStep(), 1000);\n    }\n  };\n\n  // Handle form submission\n  const handleSubmit = (e) => {\n    e.preventDefault();\n\n    // Debug logging\n    console.log('📱 Mobile form submission data:', JSON.stringify(formData, null, 2));\n    console.log('📱 Type ID:', formData.type_id, 'Type:', typeof formData.type_id);\n    console.log('📱 Brand:', formData.brand);\n    console.log('📱 Model:', formData.model);\n\n    // Enhanced validation with specific error messages\n    if (!formData.type_id || formData.type_id === '' || formData.type_id === '0') {\n      console.error('📱 Validation failed: type_id is', formData.type_id);\n      setError('Equipment type is required - please select a type');\n      return;\n    }\n\n    if (!formData.brand || formData.brand.trim() === '') {\n      console.error('📱 Validation failed: brand is', formData.brand);\n      setError('Brand is required');\n      return;\n    }\n\n    if (!formData.model || formData.model.trim() === '') {\n      console.error('📱 Validation failed: model is', formData.model);\n      setError('Model is required');\n      return;\n    }\n\n    // Ensure type_id is a number\n    const typeId = parseInt(formData.type_id, 10);\n    if (isNaN(typeId) || typeId <= 0) {\n      console.error('📱 Invalid type_id conversion:', formData.type_id, '→', typeId);\n      setError('Invalid equipment type selected');\n      return;\n    }\n\n    const equipmentData = {\n      ...formData,\n      type_id: typeId\n    };\n\n    console.log('📱 Final equipment data being sent:', JSON.stringify(equipmentData, null, 2));\n\n    createMutation.mutate({\n      equipment: equipmentData,\n      files: files,\n      referenceImageFile: null,\n      allocation: null,\n    });\n  };\n\n  // Handle cancel\n  const handleCancel = () => {\n    navigate('/equipment');\n  };\n\n  // Step navigation\n  const nextStep = () => {\n    if (currentStep < 4) setCurrentStep(currentStep + 1);\n  };\n\n  const prevStep = () => {\n    if (currentStep > 1) setCurrentStep(currentStep - 1);\n  };\n\n  const statusOptions = ['available', 'in-use', 'maintenance', 'unavailable', 'broken'];\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 pb-20\">\n      {/* Mobile Header */}\n      <div className=\"bg-white shadow-sm border-b border-gray-200 sticky top-0 z-10\">\n        <div className=\"px-4 py-3\">\n          <div className=\"flex items-center justify-between\">\n            <button\n              onClick={handleCancel}\n              className=\"p-2 text-gray-600 hover:text-gray-800\"\n            >\n              <svg className=\"w-6 h-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n              </svg>\n            </button>\n            <h1 className=\"text-lg font-semibold text-gray-800\">Add Equipment</h1>\n            <div className=\"w-10\"></div>\n          </div>\n          \n          {/* Progress Indicator */}\n          <div className=\"mt-3\">\n            <div className=\"flex items-center justify-between text-xs text-gray-500 mb-2\">\n              <span>Step {currentStep} of 4</span>\n              <span>{Math.round((currentStep / 4) * 100)}%</span>\n            </div>\n            <div className=\"w-full bg-gray-200 rounded-full h-2\">\n              <div \n                className=\"bg-blue-600 h-2 rounded-full transition-all duration-300\"\n                style={{ width: `${(currentStep / 4) * 100}%` }}\n              ></div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Error Display */}\n      {error && (\n        <div className=\"mx-4 mt-4 p-3 bg-red-50 border border-red-200 rounded-lg\">\n          <div className=\"flex items-center\">\n            <svg className=\"w-4 h-4 text-red-400 mr-2\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n            </svg>\n            <span className=\"text-sm text-red-700\">{error}</span>\n            <button\n              onClick={() => setError('')}\n              className=\"ml-auto text-red-400 hover:text-red-600\"\n            >\n              <svg className=\"w-4 h-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n              </svg>\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* Success Display */}\n      {isSuccess && (\n        <div className=\"mx-4 mt-4 p-3 bg-green-50 border border-green-200 rounded-lg\">\n          <div className=\"flex items-center\">\n            <svg className=\"w-4 h-4 text-green-400 mr-2\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" />\n            </svg>\n            <span className=\"text-sm text-green-700\">Equipment created! Redirecting...</span>\n          </div>\n        </div>\n      )}\n\n      {/* Form Content */}\n      <form onSubmit={handleSubmit} className=\"px-4 py-4\">\n        {/* Step 1: Basic Information */}\n        {currentStep === 1 && (\n          <div className=\"space-y-4\">\n            <div className=\"bg-white rounded-lg p-4 shadow-sm\">\n              <h2 className=\"text-base font-semibold text-gray-800 mb-4\">Basic Information</h2>\n              \n              {/* Equipment Type */}\n              <div className=\"mb-4\">\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">Equipment Type *</label>\n                <select\n                  name=\"type_id\"\n                  value={formData.type_id}\n                  onChange={handleInputChange}\n                  className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                  required\n                >\n                  <option value=\"\">Select Type</option>\n                  {typesData?.types?.map((type) => (\n                    <option key={type.id} value={type.id}>\n                      {type.name}\n                    </option>\n                  ))}\n                </select>\n              </div>\n\n              {/* Category */}\n              <div className=\"mb-4\">\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">Category</label>\n                <select\n                  name=\"category_id\"\n                  value={formData.category_id}\n                  onChange={handleInputChange}\n                  className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                >\n                  <option value=\"\">Select Category</option>\n                  {categoriesData?.categories?.map((category) => (\n                    <option key={category.id} value={category.id}>\n                      {category.name}\n                    </option>\n                  ))}\n                </select>\n              </div>\n\n              {/* Brand */}\n              <div className=\"mb-4\">\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">Brand *</label>\n                <input\n                  type=\"text\"\n                  name=\"brand\"\n                  value={formData.brand}\n                  onChange={handleInputChange}\n                  className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                  placeholder=\"Enter brand\"\n                  required\n                />\n              </div>\n\n              {/* Model */}\n              <div className=\"mb-4\">\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">Model *</label>\n                <input\n                  type=\"text\"\n                  name=\"model\"\n                  value={formData.model}\n                  onChange={handleInputChange}\n                  className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                  placeholder=\"Enter model\"\n                  required\n                />\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Step 2: Serial Number & Scanning */}\n        {currentStep === 2 && (\n          <div className=\"space-y-4\">\n            <div className=\"bg-white rounded-lg p-4 shadow-sm\">\n              <h2 className=\"text-base font-semibold text-gray-800 mb-4\">Serial Number (Optional)</h2>\n              \n              {/* Serial Number with Barcode Scanner */}\n              <div className=\"mb-4\">\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">Serial Number</label>\n                <div className=\"relative\">\n                  <input\n                    type=\"text\"\n                    name=\"serial_number\"\n                    value={formData.serial_number}\n                    onChange={handleInputChange}\n                    className=\"w-full p-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                    placeholder=\"Enter or scan serial number (optional)\"\n                  />\n                  <button\n                    type=\"button\"\n                    onClick={() => setShowBarcodeScanner(true)}\n                    className=\"absolute right-2 top-1/2 transform -translate-y-1/2 p-2 text-blue-600 hover:text-blue-800\"\n                  >\n                    <svg className=\"w-5 h-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z\" />\n                    </svg>\n                  </button>\n                </div>\n                <p className=\"text-xs text-gray-500 mt-1\">Tap the scan icon to use your camera, or skip if no barcode available</p>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Step 3: Location & Status */}\n        {currentStep === 3 && (\n          <div className=\"space-y-4\">\n            <div className=\"bg-white rounded-lg p-4 shadow-sm\">\n              <h2 className=\"text-base font-semibold text-gray-800 mb-4\">Location & Status</h2>\n              \n              {/* Location */}\n              <div className=\"mb-4\">\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">Location</label>\n                <select\n                  name=\"location_id\"\n                  value={formData.location_id}\n                  onChange={handleInputChange}\n                  className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                >\n                  <option value=\"\">Select Location</option>\n                  {locationsData?.locations?.map((location) => (\n                    <option key={location.id} value={location.id}>\n                      {location.name}\n                      {location.city && ` (${location.city})`}\n                    </option>\n                  ))}\n                </select>\n              </div>\n\n              {/* Status */}\n              <div className=\"mb-4\">\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">Status *</label>\n                <select\n                  name=\"status\"\n                  value={formData.status}\n                  onChange={handleInputChange}\n                  className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                  required\n                >\n                  {statusOptions.map((status) => (\n                    <option key={status} value={status}>\n                      {status.charAt(0).toUpperCase() + status.slice(1).replace('-', ' ')}\n                    </option>\n                  ))}\n                </select>\n              </div>\n\n              {/* Quantity */}\n              <div className=\"mb-4\">\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">Quantity *</label>\n                <input\n                  type=\"number\"\n                  name=\"quantity\"\n                  min=\"1\"\n                  value={formData.quantity}\n                  onChange={handleInputChange}\n                  className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                  required\n                />\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Step 4: Description & Review */}\n        {currentStep === 4 && (\n          <div className=\"space-y-4\">\n            <div className=\"bg-white rounded-lg p-4 shadow-sm\">\n              <h2 className=\"text-base font-semibold text-gray-800 mb-4\">Description & Review</h2>\n              \n              {/* Description */}\n              <div className=\"mb-4\">\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">Description</label>\n                <textarea\n                  name=\"description\"\n                  value={formData.description}\n                  onChange={handleInputChange}\n                  rows=\"3\"\n                  className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                  placeholder=\"Enter description (optional)\"\n                />\n              </div>\n\n              {/* Review Summary */}\n              <div className=\"bg-gray-50 rounded-lg p-3\">\n                <h3 className=\"text-sm font-medium text-gray-800 mb-2\">Review</h3>\n                <div className=\"space-y-1 text-sm text-gray-600\">\n                  <div><strong>Type:</strong> {typesData?.types?.find(t => t.id.toString() === formData.type_id)?.name || 'Not selected'}</div>\n                  <div><strong>Category:</strong> {categoriesData?.categories?.find(c => c.id.toString() === formData.category_id)?.name || 'Not selected'}</div>\n                  <div><strong>Brand:</strong> {formData.brand || 'Not entered'}</div>\n                  <div><strong>Model:</strong> {formData.model || 'Not entered'}</div>\n                  <div><strong>Serial:</strong> {formData.serial_number || 'Not provided'}</div>\n                  <div><strong>Location:</strong> {locationsData?.locations?.find(l => l.id.toString() === formData.location_id)?.name || 'Default Storage'}</div>\n                  <div><strong>Status:</strong> {formData.status}</div>\n                  <div><strong>Quantity:</strong> {formData.quantity}</div>\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n      </form>\n\n      {/* Fixed Bottom Navigation */}\n      <div className=\"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-4\">\n        <div className=\"flex items-center justify-between\">\n          {/* Previous Button */}\n          <Button\n            type=\"button\"\n            variant=\"secondary\"\n            onClick={prevStep}\n            disabled={currentStep === 1}\n            className=\"flex-1 mr-2\"\n          >\n            Previous\n          </Button>\n\n          {/* Next/Submit Button */}\n          {currentStep < 4 ? (\n            <Button\n              type=\"button\"\n              variant=\"primary\"\n              onClick={nextStep}\n              className=\"flex-1 ml-2\"\n            >\n              Next\n            </Button>\n          ) : (\n            <Button\n              type=\"submit\"\n              variant=\"primary\"\n              onClick={handleSubmit}\n              disabled={createMutation.isLoading}\n              className=\"flex-1 ml-2\"\n            >\n              {createMutation.isLoading ? (\n                <div className=\"flex items-center justify-center\">\n                  <svg className=\"animate-spin -ml-1 mr-2 h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\">\n                    <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                    <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n                  </svg>\n                  Creating...\n                </div>\n              ) : (\n                'Create Equipment'\n              )}\n            </Button>\n          )}\n        </div>\n      </div>\n\n      {/* Barcode Scanner Modal */}\n      <BarcodeScanner\n        isOpen={showBarcodeScanner}\n        onScan={handleBarcodeScan}\n        onClose={() => setShowBarcodeScanner(false)}\n        onError={(error) => {\n          console.error('Barcode scanner error:', error);\n          toast.error('Scanner error: ' + error, { icon: '📱❌' });\n        }}\n      />\n    </div>\n  );\n};\n\nexport default NewEquipmentMobile;\n"],"names":["NewEquipmentMobile","navigate","useNavigate","useAuth","queryClient","useQueryClient","currentStep","setCurrentStep","useState","formData","setFormData","files","setFiles","error","setError","isSuccess","setIsSuccess","showBarcodeScanner","setShowBarcodeScanner","typesData","useQuery","getEquipmentTypes","locationsData","getLocations","categoriesData","getCategories","defaultStorageData","axios","useEffect","_a","defaultStorage","prev","createMutation","useMutation","createEquipment","data","toast","errorMessage","handleInputChange","e","name","value","selectedCategory","cat","selectedLocation","_b","loc","handleBarcodeScan","scannedValue","nextStep","handleSubmit","typeId","equipmentData","handleCancel","prevStep","statusOptions","jsxs","jsx","type","category","_c","location","status","_e","_d","t","_g","_f","c","_i","_h","l","Button","BarcodeScanner"],"mappings":"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"}